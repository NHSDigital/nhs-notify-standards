{
  "$id": "https://nhsdigital.github.io/nhs-notify-standards/cloudevents/nhs-notify-metadata.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "NHS Notify Metadata",
  "type": "object",
  "description": "Notify Metadata",
  "additionalProperties": false,
  "required": [
    "version",
    "teamResponsible",
    "notifyDomain"
  ],
  "properties": {
    "teamResponsible": {
      "type": "string",
      "enum": ["Team 1","Team 2","Team 3"],
      "description": "Owning engineering team accountable for this event's domain logic.",
      "examples": ["Team 1"]
    },
    "notifyDomain": {
      "type": "string",
      "enum": ["Ordering","Delivering","Reporting","Enquiries"],
      "description": "High-level business domain to which the event belongs.",
      "examples": ["Ordering"]
    },
    "microservice":{
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "pattern": "^[a-zA-Z0-9-]+$",
      "description": "The name of the microservice generating the event, e.g. order-service",
      "examples": ["order-service"]
    },
    "repositoryUrl": {
      "type": "string",
      "format": "uri",
      "description": "The URL of the repository containing the microservice codebase",
      "examples": ["https://github.com/nhsdigital/nhs-notify-standards"]
    },
    "accountId": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "pattern": "^[a-zA-Z0-9-]+$",
      "description": "The cloud account id where the microservice is deployed, for example the AWS account id",
      "examples": ["123456789012", "my-cloud-account"]
    },
    "environment": {
      "type": "string",
      "enum": ["development", "testing", "staging", "production"],
      "description": "The deployment environment of the microservice generating the event",
      "examples": ["production"]
    },
    "instance":{
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "pattern": "^[a-zA-Z0-9-]+$",
      "description": "The specific instance name of the deployment, eg Notify Standard, or Notify Hot backup, or Notify Priority customers",
      "examples": ["primary", "hot-backup", "priority-customers"]
    },
    "microserviceInstanceId":{
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "pattern": "^[a-zA-Z0-9-]+$",
      "description": "The specific instance id of the microservice generating the event, for example the lambda id or pod name",
      "examples": ["lambda-1", "pod-1234" ]
    },    
    "version": {
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
      "description": "Semantic version (SemVer 2.0.0) of the producing microservice at emit time.",
      "examples": ["1.3.0", "2.0.0-beta.1"]
    }
  },
  "examples": [
    {"teamResponsible": "Team 1", "notifyDomain": "Ordering", "microservice": "order-service", "version": "1.3.0"},
    {"teamResponsible": "Team 2", "notifyDomain": "Reporting", "microservice": "reporting-api", "version": "2.0.0"}
  ]
}