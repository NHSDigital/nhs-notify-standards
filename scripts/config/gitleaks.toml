# SEE: https://github.com/gitleaks/gitleaks/#configuration
# Do not edit this file directly as it will be overwritten by changes from the nhs-notify-repository-template on next sync

[extend]
useDefault = true # SEE: https://github.com/gitleaks/gitleaks/blob/master/config/gitleaks.toml

[[rules]]
description = "IPv4"
id = "ipv4"
regex = '''[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}'''

[rules.allowlist]
regexTarget = "match"
regexes = [
  # Exclude the private network IPv4 addresses as well as the DNS servers for Google and OpenDNS
  '''(127\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}|10\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}|172\.(1[6-9]|2[0-9]|3[0-1])\.[0-9]{1,3}\.[0-9]{1,3}|192\.168\.[0-9]{1,3}\.[0-9]{1,3}|0\.0\.0\.0|255\.255\.255\.255|8\.8\.8\.8|8\.8\.4\.4|208\.67\.222\.222|208\.67\.220\.220)''',
]

[allowlist]
paths = [
  '''.terraform.lock.hcl''',
  '''poetry.lock''',
  '''yarn.lock''',
  '''Gemfile.lock''',
  '''fhir/input-cache/schemas/R4/fhir-single.xsd''',
  '''fhir/input-cache/schemas/R5/fhir-single.xsd''',
  '''fhir/input-cache/txcache/.terminologyCapabilities.tx.fhir.org.r4.cache''',
  '''fhir/docs/codesystem-ref-all-list.csv''',
  '''fhir/docs/codesystem-ref-all-list.json''',
  '''fhir/docs/valueset-ref-all-list.csv''',
  '''fhir/docs/valueset-ref-all-list.json'''
]

# Exclude Chrome version in user agent
regexTarget = "line"
regexes = [
  '''Chrome/[\d.]+'''
]
